<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0"
    />
    <meta name="description" content="–ü–∞–Ω–µ–ª—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è ‚Äî Core City" />
    <title>–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å ‚Äî Core City</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <!-- Leaflet MarkerCluster CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
    />
    <!-- –ù–∞—à–∏ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/worker.css" />
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar">
      <div class="container">
        <div class="navbar-inner">
          <div class="logo">üèôÔ∏è Core City</div>
          <div class="nav-links">
            <span id="nav-username"></span>
            <span class="worker-status">üü¢ –ù–∞ —Å–º–µ–Ω–µ</span>
            <button onclick="logout()" class="btn-logout">–í—ã–π—Ç–∏</button>
          </div>
        </div>
      </div>
    </nav>

    <div class="worker-layout">
      <!-- Sidebar —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–¥–∞—á -->
      <aside class="worker-sidebar">
        <div class="sidebar-header">
          <h2>üìã –ú–æ–∏ –∑–∞–¥–∞—á–∏</h2>
          <div class="task-filters">
            <select id="taskStatusFilter" class="input" style="height: 40px">
              <option value="assigned">–ù–∞–∑–Ω–∞—á–µ–Ω–æ</option>
              <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
              <option value="all">–í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ</option>
            </select>
          </div>
        </div>

        <div id="taskList" class="task-list">
          <!-- –ó–∞–¥–∞—á–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
          <div
            class="text-center"
            style="padding: 24px; color: var(--gray-500)"
          >
            ‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á...
          </div>
        </div>

        <div class="worker-stats">
          <div class="stat-item">
            <span class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</span>
            <span class="stat-value" id="todayCompleted">4/9</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">–†–µ–π—Ç–∏–Ω–≥</span>
            <span class="stat-value" id="workerRating">4.8 ‚≠ê</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">–í—Ä–µ–º—è —Å–º–µ–Ω—ã</span>
            <span class="stat-value" id="shiftTime">05:23:47</span>
          </div>
        </div>
      </aside>

      <!-- –û—Å–Ω–æ–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å —Å –∫–∞—Ä—Ç–æ–π –∏ –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–¥–∞—á–∏ -->
      <main class="worker-main">
        <!-- –ö–∞—Ä—Ç–∞ -->
        <div
          id="map"
          style="
            height: 400px;
            width: 100%;
            border-radius: 16px;
            margin-bottom: 24px;
          "
        ></div>

        <!-- –î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏ -->
        <div id="taskDetail" class="card">
          <div
            class="text-center"
            style="padding: 40px; color: var(--gray-500)"
          >
            üó∫Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞—á—É –∏–∑ —Å–ø–∏—Å–∫–∞
          </div>
        </div>
      </main>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <!-- –ù–∞—à–∏ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="js/auth.js"></script>
    <script src="js/worker.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        if (!requireAuth()) return;

        const user = getCurrentUser();
        if (user) {
          document.getElementById("nav-username").textContent =
            user.full_name || user.email;
        }

        initWorkerPage();
      });
    </script>
  </body>
</html>
